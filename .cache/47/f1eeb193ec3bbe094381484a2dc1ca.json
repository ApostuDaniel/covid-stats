{"id":"ugMK","dependencies":[{"name":"E:\\WebProjects\\covid-vaccination-stats\\node_modules\\csvtojson\\v2\\dataClean.js.map","includedInParent":true,"mtime":1629577339736},{"name":"E:\\WebProjects\\covid-vaccination-stats\\node_modules\\csvtojson\\src\\dataClean.ts","includedInParent":true,"mtime":1629577339416},{"name":"E:\\WebProjects\\covid-vaccination-stats\\package.json","includedInParent":true,"mtime":1631039448036},{"name":"E:\\WebProjects\\covid-vaccination-stats\\node_modules\\csvtojson\\package.json","includedInParent":true,"mtime":1629577336736},{"name":"strip-bom","loc":{"line":6,"column":42},"parent":"E:\\WebProjects\\covid-vaccination-stats\\node_modules\\csvtojson\\v2\\dataClean.js","resolved":"E:\\WebProjects\\covid-vaccination-stats\\node_modules\\strip-bom\\index.js"},{"name":"buffer","parent":"E:\\WebProjects\\covid-vaccination-stats\\node_modules\\csvtojson\\v2\\dataClean.js","resolved":"E:\\WebProjects\\covid-vaccination-stats\\node_modules\\buffer\\index.js"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar e=require(\"buffer\").Buffer,r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,\"__esModule\",{value:!0});var t=r(require(\"strip-bom\"));function f(e,r){var f=u(e,r);r.csvLineBuffer=void 0;var i=n(f,r).toString(\"utf8\");return!1===r.started?t.default(i):i}function u(r,t){return t.csvLineBuffer&&t.csvLineBuffer.length>0?e.concat([t.csvLineBuffer,r]):r}function n(e,r){var t=e.length-1;if(0!=(128&e[t])){for(;128==(192&e[t]);)t--;t--}return t!=e.length-1?(r.csvLineBuffer=e.slice(t+1),e.slice(0,t+1)):e}exports.prepareData=f;"},"sourceMaps":{"js":{"mappings":[{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":0}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":4}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":6}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":14}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":24}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":31}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":33}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":39}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":44}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":61}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":70}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":73}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":80}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":83}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":85}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":96}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":98}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":99}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":107}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":111}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":118}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":133}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":141}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":154}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":155}},{"source":"../src/dataClean.ts","name":null,"original":{"line":63,"column":1},"generated":{"line":2,"column":162}},{"source":"../src/dataClean.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":2,"column":166}},{"source":"../src/dataClean.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":2,"column":170}},{"source":"../src/dataClean.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":2,"column":172}},{"source":"../src/dataClean.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":2,"column":174}},{"source":"../src/dataClean.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":2,"column":182}},{"source":"../src/dataClean.ts","name":null,"original":{"line":9,"column":0},"generated":{"line":2,"column":196}},{"source":"../src/dataClean.ts","name":null,"original":{"line":9,"column":0},"generated":{"line":2,"column":205}},{"source":"../src/dataClean.ts","name":null,"original":{"line":9,"column":28},"generated":{"line":2,"column":207}},{"source":"../src/dataClean.ts","name":null,"original":{"line":9,"column":43},"generated":{"line":2,"column":209}},{"source":"../src/dataClean.ts","name":null,"original":{"line":10,"column":8},"generated":{"line":2,"column":212}},{"source":"../src/dataClean.ts","name":null,"original":{"line":10,"column":8},"generated":{"line":2,"column":216}},{"source":"../src/dataClean.ts","name":null,"original":{"line":10,"column":20},"generated":{"line":2,"column":218}},{"source":"../src/dataClean.ts","name":null,"original":{"line":10,"column":36},"generated":{"line":2,"column":220}},{"source":"../src/dataClean.ts","name":null,"original":{"line":10,"column":43},"generated":{"line":2,"column":222}},{"source":"../src/dataClean.ts","name":null,"original":{"line":11,"column":2},"generated":{"line":2,"column":225}},{"source":"../src/dataClean.ts","name":null,"original":{"line":11,"column":10},"generated":{"line":2,"column":227}},{"source":"../src/dataClean.ts","name":null,"original":{"line":11,"column":26},"generated":{"line":2,"column":246}},{"source":"../src/dataClean.ts","name":null,"original":{"line":12,"column":8},"generated":{"line":2,"column":248}},{"source":"../src/dataClean.ts","name":null,"original":{"line":12,"column":8},"generated":{"line":2,"column":252}},{"source":"../src/dataClean.ts","name":null,"original":{"line":12,"column":25},"generated":{"line":2,"column":254}},{"source":"../src/dataClean.ts","name":null,"original":{"line":12,"column":40},"generated":{"line":2,"column":256}},{"source":"../src/dataClean.ts","name":null,"original":{"line":12,"column":51},"generated":{"line":2,"column":258}},{"source":"../src/dataClean.ts","name":null,"original":{"line":12,"column":60},"generated":{"line":2,"column":261}},{"source":"../src/dataClean.ts","name":null,"original":{"line":12,"column":69},"generated":{"line":2,"column":270}},{"source":"../src/dataClean.ts","name":null,"original":{"line":13,"column":6},"generated":{"line":2,"column":278}},{"source":"../src/dataClean.ts","name":null,"original":{"line":13,"column":26},"generated":{"line":2,"column":285}},{"source":"../src/dataClean.ts","name":null,"original":{"line":13,"column":6},"generated":{"line":2,"column":289}},{"source":"../src/dataClean.ts","name":null,"original":{"line":13,"column":14},"generated":{"line":2,"column":291}},{"source":"../src/dataClean.ts","name":null,"original":{"line":14,"column":11},"generated":{"line":2,"column":299}},{"source":"../src/dataClean.ts","name":null,"original":{"line":14,"column":11},"generated":{"line":2,"column":301}},{"source":"../src/dataClean.ts","name":null,"original":{"line":14,"column":20},"generated":{"line":2,"column":309}},{"source":"../src/dataClean.ts","name":null,"original":{"line":16,"column":11},"generated":{"line":2,"column":312}},{"source":"../src/dataClean.ts","name":null,"original":{"line":22,"column":0},"generated":{"line":2,"column":314}},{"source":"../src/dataClean.ts","name":null,"original":{"line":22,"column":0},"generated":{"line":2,"column":323}},{"source":"../src/dataClean.ts","name":null,"original":{"line":22,"column":25},"generated":{"line":2,"column":325}},{"source":"../src/dataClean.ts","name":null,"original":{"line":22,"column":40},"generated":{"line":2,"column":327}},{"source":"../src/dataClean.ts","name":null,"original":{"line":23,"column":6},"generated":{"line":2,"column":330}},{"source":"../src/dataClean.ts","name":null,"original":{"line":23,"column":6},"generated":{"line":2,"column":337}},{"source":"../src/dataClean.ts","name":null,"original":{"line":23,"column":14},"generated":{"line":2,"column":339}},{"source":"../src/dataClean.ts","name":null,"original":{"line":23,"column":31},"generated":{"line":2,"column":354}},{"source":"../src/dataClean.ts","name":null,"original":{"line":23,"column":39},"generated":{"line":2,"column":356}},{"source":"../src/dataClean.ts","name":null,"original":{"line":23,"column":53},"generated":{"line":2,"column":370}},{"source":"../src/dataClean.ts","name":null,"original":{"line":23,"column":62},"generated":{"line":2,"column":377}},{"source":"../src/dataClean.ts","name":null,"original":{"line":24,"column":11},"generated":{"line":2,"column":379}},{"source":"../src/dataClean.ts","name":null,"original":{"line":24,"column":18},"generated":{"line":2,"column":381}},{"source":"../src/dataClean.ts","name":null,"original":{"line":24,"column":25},"generated":{"line":2,"column":388}},{"source":"../src/dataClean.ts","name":null,"original":{"line":24,"column":26},"generated":{"line":2,"column":389}},{"source":"../src/dataClean.ts","name":null,"original":{"line":24,"column":34},"generated":{"line":2,"column":391}},{"source":"../src/dataClean.ts","name":null,"original":{"line":24,"column":49},"generated":{"line":2,"column":405}},{"source":"../src/dataClean.ts","name":null,"original":{"line":26,"column":11},"generated":{"line":2,"column":409}},{"source":"../src/dataClean.ts","name":null,"original":{"line":32,"column":0},"generated":{"line":2,"column":411}},{"source":"../src/dataClean.ts","name":null,"original":{"line":32,"column":0},"generated":{"line":2,"column":420}},{"source":"../src/dataClean.ts","name":null,"original":{"line":32,"column":24},"generated":{"line":2,"column":422}},{"source":"../src/dataClean.ts","name":null,"original":{"line":32,"column":39},"generated":{"line":2,"column":424}},{"source":"../src/dataClean.ts","name":null,"original":{"line":33,"column":6},"generated":{"line":2,"column":427}},{"source":"../src/dataClean.ts","name":null,"original":{"line":33,"column":6},"generated":{"line":2,"column":431}},{"source":"../src/dataClean.ts","name":null,"original":{"line":33,"column":12},"generated":{"line":2,"column":433}},{"source":"../src/dataClean.ts","name":null,"original":{"line":33,"column":18},"generated":{"line":2,"column":435}},{"source":"../src/dataClean.ts","name":null,"original":{"line":33,"column":27},"generated":{"line":2,"column":442}},{"source":"../src/dataClean.ts","name":null,"original":{"line":41,"column":6},"generated":{"line":2,"column":444}},{"source":"../src/dataClean.ts","name":null,"original":{"line":41,"column":31},"generated":{"line":2,"column":447}},{"source":"../src/dataClean.ts","name":null,"original":{"line":41,"column":20},"generated":{"line":2,"column":451}},{"source":"../src/dataClean.ts","name":null,"original":{"line":41,"column":7},"generated":{"line":2,"column":455}},{"source":"../src/dataClean.ts","name":null,"original":{"line":41,"column":13},"generated":{"line":2,"column":457}},{"source":"../src/dataClean.ts","name":null,"original":{"line":41,"column":34},"generated":{"line":2,"column":461}},{"source":"../src/dataClean.ts","name":null,"original":{"line":42,"column":11},"generated":{"line":2,"column":462}},{"source":"../src/dataClean.ts","name":null,"original":{"line":42,"column":37},"generated":{"line":2,"column":467}},{"source":"../src/dataClean.ts","name":null,"original":{"line":42,"column":25},"generated":{"line":2,"column":473}},{"source":"../src/dataClean.ts","name":null,"original":{"line":42,"column":12},"generated":{"line":2,"column":477}},{"source":"../src/dataClean.ts","name":null,"original":{"line":42,"column":18},"generated":{"line":2,"column":479}},{"source":"../src/dataClean.ts","name":null,"original":{"line":43,"column":6},"generated":{"line":2,"column":484}},{"source":"../src/dataClean.ts","name":null,"original":{"line":45,"column":4},"generated":{"line":2,"column":488}},{"source":"../src/dataClean.ts","name":null,"original":{"line":47,"column":6},"generated":{"line":2,"column":492}},{"source":"../src/dataClean.ts","name":null,"original":{"line":47,"column":6},"generated":{"line":2,"column":499}},{"source":"../src/dataClean.ts","name":null,"original":{"line":47,"column":13},"generated":{"line":2,"column":502}},{"source":"../src/dataClean.ts","name":null,"original":{"line":47,"column":19},"generated":{"line":2,"column":504}},{"source":"../src/dataClean.ts","name":null,"original":{"line":47,"column":28},"generated":{"line":2,"column":511}},{"source":"../src/dataClean.ts","name":null,"original":{"line":48,"column":4},"generated":{"line":2,"column":514}},{"source":"../src/dataClean.ts","name":null,"original":{"line":48,"column":12},"generated":{"line":2,"column":516}},{"source":"../src/dataClean.ts","name":null,"original":{"line":48,"column":28},"generated":{"line":2,"column":530}},{"source":"../src/dataClean.ts","name":null,"original":{"line":48,"column":34},"generated":{"line":2,"column":532}},{"source":"../src/dataClean.ts","name":null,"original":{"line":48,"column":40},"generated":{"line":2,"column":538}},{"source":"../src/dataClean.ts","name":null,"original":{"line":48,"column":46},"generated":{"line":2,"column":540}},{"source":"../src/dataClean.ts","name":null,"original":{"line":49,"column":11},"generated":{"line":2,"column":543}},{"source":"../src/dataClean.ts","name":null,"original":{"line":49,"column":17},"generated":{"line":2,"column":545}},{"source":"../src/dataClean.ts","name":null,"original":{"line":49,"column":23},"generated":{"line":2,"column":551}},{"source":"../src/dataClean.ts","name":null,"original":{"line":49,"column":26},"generated":{"line":2,"column":553}},{"source":"../src/dataClean.ts","name":null,"original":{"line":49,"column":32},"generated":{"line":2,"column":555}},{"source":"../src/dataClean.ts","name":null,"original":{"line":61,"column":11},"generated":{"line":2,"column":559}},{"source":"../src/dataClean.ts","name":null,"original":{"line":9,"column":0},"generated":{"line":2,"column":561}},{"source":"../src/dataClean.ts","name":null,"original":{"line":9,"column":0},"generated":{"line":2,"column":569}},{"source":"../src/dataClean.ts","name":null,"original":{"line":9,"column":0},"generated":{"line":2,"column":581}}],"sources":{"../src/dataClean.ts":"import { ParseRuntime } from \"./ParseRuntime\";\nimport stripBom from \"strip-bom\";\n/**\n * For each data chunk coming to parser:\n * 1. append the data to the buffer that is left from last chunk\n * 2. check if utf8 chars being split, if does, stripe the bytes and add to left buffer.\n * 3. stripBom \n */\nexport function prepareData(chunk: Buffer, runtime: ParseRuntime): string {\n  const workChunk = concatLeftChunk(chunk, runtime);\n  runtime.csvLineBuffer = undefined;\n  const cleanCSVString = cleanUtf8Split(workChunk, runtime).toString(\"utf8\");\n  if (runtime.started === false) {\n    return stripBom(cleanCSVString);\n  } else {\n    return cleanCSVString;\n  }\n}\n/**\n *  append data to buffer that is left form last chunk\n */\nfunction concatLeftChunk(chunk: Buffer, runtime: ParseRuntime): Buffer {\n  if (runtime.csvLineBuffer && runtime.csvLineBuffer.length > 0) {\n    return Buffer.concat([runtime.csvLineBuffer, chunk]);\n  } else {\n    return chunk;\n  }\n}\n/**\n * check if utf8 chars being split, if does, stripe the bytes and add to left buffer.\n */\nfunction cleanUtf8Split(chunk: Buffer, runtime: ParseRuntime): Buffer {\n  let idx = chunk.length - 1;\n  /**\n   * From Keyang:\n   * The code below is to check if a single utf8 char (which could be multiple bytes) being split.\n   * If the char being split, the buffer from two chunk needs to be concat\n   * check how utf8 being encoded to understand the code below. \n   * If anyone has any better way to do this, please let me know.\n   */\n  if ((chunk[idx] & 1 << 7) != 0) {\n    while ((chunk[idx] & 3 << 6) === 128) {\n      idx--;\n    }\n    idx--;\n  }\n  if (idx != chunk.length - 1) {\n    runtime.csvLineBuffer = chunk.slice(idx + 1);\n    return chunk.slice(0, idx + 1)\n    // var _cb=cb;\n    // var self=this;\n    // cb=function(){\n    //   if (self._csvLineBuffer){\n    //     self._csvLineBuffer=Buffer.concat([bufFromString(self._csvLineBuffer,\"utf8\"),left]);\n    //   }else{\n    //     self._csvLineBuffer=left;\n    //   }\n    //   _cb();\n    // }\n  } else {\n    return chunk;\n  }\n}"},"lineCount":null}},"error":null,"hash":"1d24c0b8598b0222fe953265008aea3c","cacheData":{"env":{}}}